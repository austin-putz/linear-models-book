{
  "hash": "0ce27381f3eda88420509378d5464ff3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 8: Contrasts and Estimable Functions\"\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    number-sections: true\n    code-fold: false\n    code-tools: true\nbibliography: ../references.bib\n---\n\n::: {.callout-note icon=false}\n## Learning Objectives\n\nBy the end of this week, you will be able to:\n\n1. **Define** **linear contrasts** and **estimable functions** in **overparameterized models**\n2. **Determine** which functions are **estimable** using the **row space criterion**\n3. **Construct** and **test** hypotheses involving **single** and **multiple contrasts**\n4. **Create** **orthogonal contrast sets** and understand their role in **partitioning sums of squares**\n5. **Compute** **standard errors** and **test statistics** for estimable functions\n:::\n\n## Why Contrasts Matter in Animal Breeding\n\nAfter fitting a one-way ANOVA model (Week 7), we can test whether there are overall differences among treatment groups. But in animal breeding and genetics, we often have **specific questions** that go beyond \"Are the groups different?\"\n\n**Common questions in livestock science:**\n\n- **Breed comparisons**: Is Angus different from Hereford? Are British breeds different from Continental breeds?\n- **Genetic lines**: Is Line A superior to the average of Lines B, C, and D?\n- **Sire evaluation**: Which sires produce significantly different offspring performance?\n- **Treatment effects**: Is a new diet formulation different from the control?\n- **Selection strategies**: Do selected lines differ from unselected control lines?\n\nEach of these questions can be formulated as a **contrast** — a specific linear combination of treatment means. Contrasts allow us to test targeted hypotheses rather than just omnibus \"any difference\" tests.\n\n::: {.callout-note}\n## Connection to Week 7\n\nIn Week 7, we learned about one-way ANOVA and the F-test for overall treatment effects. The F-test tells us **if** there are differences among groups, but not **which** groups differ or **how** they differ.\n\nContrasts provide the tools to answer these specific questions. They are the natural next step after establishing that groups differ overall.\n:::\n\n::: {.callout-tip}\n## Why Geneticists Care About Specific Comparisons\n\nIn genetic improvement programs, we rarely care about \"Are all breeds different?\" Instead, we want to know:\n\n- Which crosses produce the best offspring? (comparing specific crosses)\n- Is a new selection line better than the base population? (selected vs. control)\n- Which sire should we use for specific mating goals? (pairwise sire comparisons)\n- Do different production systems affect a trait? (system A vs. B, or A vs. average of others)\n\nContrasts are the statistical tool that translates breeding questions into testable hypotheses.\n:::\n\n### The Estimability Problem\n\nIn Week 7, we encountered an important issue: when using the **effects model** for one-way ANOVA:\n\n$$\ny_{ij} = \\mu + \\alpha_i + e_{ij}\n$$\n\nthe design matrix $\\mathbf{X}$ is **not full rank**. This means:\n\n- The normal equations have infinitely many solutions\n- Individual parameters ($\\mu$, $\\alpha_1$, $\\alpha_2$, etc.) are not uniquely estimable\n- Different constraints (or different generalized inverses) give different estimates\n\nHowever, **differences** between treatment effects (contrasts like $\\alpha_1 - \\alpha_2$) **are** uniquely estimable. The concept of **estimability** helps us understand which functions of parameters have unique, interpretable estimates.\n\nThis week, we'll develop the mathematical theory of estimable functions and show how to identify, estimate, and test them.\n\n## Mathematical Theory\n\n### Linear Combinations and Contrasts\n\nA **linear combination** of parameters is any expression of the form:\n\n$$\n\\psi = c_1 \\beta_1 + c_2 \\beta_2 + \\cdots + c_p \\beta_p = \\mathbf{c}'\\boldsymbol{\\beta}\n$$ {#eq-linear-combination}\n\nwhere $\\mathbf{c}$ is a $p \\times 1$ vector of constants and $\\boldsymbol{\\beta}$ is the $p \\times 1$ vector of model parameters.\n\n**Examples** (for one-way ANOVA with cell means $\\mu_1, \\mu_2, \\mu_3, \\mu_4$):\n\n1. **Pairwise comparison**: $\\mu_1 - \\mu_2$, where $\\mathbf{c} = [1, -1, 0, 0]'$\n\n2. **One vs. average of others**: $\\mu_1 - \\frac{1}{3}(\\mu_2 + \\mu_3 + \\mu_4)$, where $\\mathbf{c} = [1, -\\frac{1}{3}, -\\frac{1}{3}, -\\frac{1}{3}]'$\n\n3. **Group comparison**: $\\frac{\\mu_1 + \\mu_2}{2} - \\frac{\\mu_3 + \\mu_4}{2}$, where $\\mathbf{c} = [\\frac{1}{2}, \\frac{1}{2}, -\\frac{1}{2}, -\\frac{1}{2}]'$\n\nA **contrast** is a special type of linear combination where the coefficients sum to zero:\n\n$$\n\\sum_{i=1}^{p} c_i = 0 \\quad \\text{or} \\quad \\mathbf{c}'\\mathbf{1} = 0\n$$\n\nwhere $\\mathbf{1}$ is a vector of ones.\n\n::: {.callout-note}\n## Why \"Contrast\"?\n\nThe term \"contrast\" comes from the idea of comparing or contrasting groups. When $\\sum c_i = 0$, we're comparing weighted averages of some groups against weighted averages of others — no single group stands alone.\n\nIn the context of treatment means (cell means model), all pairwise comparisons and group comparisons are contrasts.\n:::\n\n### Estimable Functions\n\n::: {.callout-important}\n## Definition: Estimable Function\n\nA linear function $\\mathbf{c}'\\boldsymbol{\\beta}$ is **estimable** if and only if there exists a vector $\\mathbf{a}$ such that:\n\n$$\n\\mathbf{c}' = \\mathbf{a}'\\mathbf{X}\n$$\n\nEquivalently, $\\mathbf{c}'$ is in the **row space** of $\\mathbf{X}$.\n:::\n\n**Intuition**: A function is estimable if it can be expressed as a linear combination of the rows of the design matrix. This ensures that the function can be uniquely estimated from the data, regardless of which generalized inverse we use.\n\n#### Key Theorems\n\n**Theorem 1**: If $\\mathbf{X}$ is **full rank** (rank $= p$), then **all** linear functions $\\mathbf{c}'\\boldsymbol{\\beta}$ are estimable.\n\n**Theorem 2**: If $\\mathbf{X}$ is **not full rank** (rank $< p$), then only certain linear functions are estimable.\n\n**Theorem 3**: For the **cell means model** in one-way ANOVA, all contrasts $\\sum c_i \\mu_i$ (where $\\sum c_i = 0$) are estimable.\n\n**Theorem 4**: For the **effects model** with sum-to-zero constraint:\n- Individual parameters $\\mu$ and $\\alpha_i$ are **NOT estimable**\n- But differences $\\alpha_i - \\alpha_j$ **ARE estimable**\n\n### Estimation and Variance\n\n::: {.callout-important}\n## Key Property: Uniqueness\n\nIf $\\mathbf{c}'\\boldsymbol{\\beta}$ is estimable, then its estimate $\\mathbf{c}'\\mathbf{b}$ is **unique** — it does not depend on which generalized inverse $(\\mathbf{X}'\\mathbf{X})^{-}$ is used to solve the normal equations.\n:::\n\nFor an estimable function $\\mathbf{c}'\\boldsymbol{\\beta}$, the variance of its estimate is:\n\n$$\n\\text{Var}(\\mathbf{c}'\\mathbf{b}) = \\mathbf{c}'(\\mathbf{X}'\\mathbf{X})^{-}\\mathbf{c} \\, \\sigma^2\n$$ {#eq-var-contrast}\n\nWe estimate $\\sigma^2$ from the residuals:\n\n$$\n\\hat{\\sigma}^2 = \\text{MSE} = \\frac{\\text{SSE}}{n - r(\\mathbf{X})}\n$$\n\n### Hypothesis Testing\n\n#### Single Contrast\n\nTo test $H_0: \\mathbf{c}'\\boldsymbol{\\beta} = 0$ vs. $H_a: \\mathbf{c}'\\boldsymbol{\\beta} \\neq 0$:\n\n**Test statistic**:\n$$\nt = \\frac{\\mathbf{c}'\\mathbf{b}}{\\text{se}(\\mathbf{c}'\\mathbf{b})} = \\frac{\\mathbf{c}'\\mathbf{b}}{\\sqrt{\\mathbf{c}'(\\mathbf{X}'\\mathbf{X})^{-}\\mathbf{c} \\, \\hat{\\sigma}^2}}\n$$ {#eq-t-test-contrast}\n\nUnder $H_0$, $t \\sim t(n - r(\\mathbf{X}))$.\n\n#### Multiple Contrasts\n\nTo test $H_0: \\mathbf{C}\\boldsymbol{\\beta} = \\mathbf{0}$ where $\\mathbf{C}$ is a $q \\times p$ matrix:\n\n**F-test statistic**:\n$$\nF = \\frac{\\mathbf{b}'\\mathbf{C}'[\\mathbf{C}(\\mathbf{X}'\\mathbf{X})^{-}\\mathbf{C}']^{-1}\\mathbf{C}\\mathbf{b} / q}{\\text{MSE}}\n$$ {#eq-f-test-contrasts}\n\nUnder $H_0$, $F \\sim F(q, n - r(\\mathbf{X}))$.\n\n### Orthogonal Contrasts\n\nTwo estimable functions $\\mathbf{c}_1'\\boldsymbol{\\beta}$ and $\\mathbf{c}_2'\\boldsymbol{\\beta}$ are **orthogonal** if:\n\n$$\n\\mathbf{c}_1'(\\mathbf{X}'\\mathbf{X})^{-}\\mathbf{c}_2 = 0\n$$\n\n**For balanced designs**, this simplifies to $\\mathbf{c}_1'\\mathbf{c}_2 = 0$.\n\n::: {.callout-important}\n## Property: Orthogonal Contrasts Partition Variation\n\nFor a set of $g-1$ **orthogonal contrasts** in a one-way ANOVA with $g$ groups:\n\n$$\n\\text{SS(Treatments)} = \\text{SS}(\\mathbf{c}_1) + \\text{SS}(\\mathbf{c}_2) + \\cdots + \\text{SS}(\\mathbf{c}_{g-1})\n$$\n\nwhere $\\text{SS}(\\mathbf{c}_j) = \\frac{(\\mathbf{c}_j'\\mathbf{b})^2}{\\mathbf{c}_j'(\\mathbf{X}'\\mathbf{X})^{-}\\mathbf{c}_j}$\n:::\n\n## Small Numerical Example: Beef Cattle Carcass Weight\n\nWe have data on carcass weights (kg) for 12 beef steers from 4 breeds (3 steers per breed).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load data\nbeef <- read.csv(\"data/beef_breeds_small.csv\")\nprint(beef)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       breed carcass_weight_kg\n1      Angus               250\n2      Angus               255\n3      Angus               252\n4   Hereford               248\n5   Hereford               251\n6   Hereford               250\n7  Charolais               268\n8  Charolais               270\n9  Charolais               272\n10 Simmental               265\n11 Simmental               267\n12 Simmental               266\n```\n\n\n:::\n\n```{.r .cell-code}\n# Summary by breed\nlibrary(dplyr)\nbeef_summary <- beef %>%\n  group_by(breed) %>%\n  summarise(n = n(), mean = mean(carcass_weight_kg), sd = sd(carcass_weight_kg))\nprint(beef_summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n  breed         n  mean    sd\n  <chr>     <int> <dbl> <dbl>\n1 Angus         3  252.  2.52\n2 Charolais     3  270   2   \n3 Hereford      3  250.  1.53\n4 Simmental     3  266   1   \n```\n\n\n:::\n:::\n\n\n### Fit One-Way ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Design matrix (cell means model)\ny <- beef$carcass_weight_kg\nn <- length(y)\nX <- model.matrix(~ breed - 1, data = beef)\ncolnames(X) <- levels(beef$breed)\n\n# Solve normal equations\nXtX <- t(X) %*% X\nXty <- t(X) %*% y\nb <- solve(XtX) %*% Xty\ncat(\"Breed means:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBreed means:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(b)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         [,1]\n[1,] 252.3333\n[2,] 270.0000\n[3,] 249.6667\n[4,] 266.0000\n```\n\n\n:::\n\n```{.r .cell-code}\n# ANOVA components\ny_hat <- X %*% b\nresiduals <- y - y_hat\nSST <- sum((y - mean(y))^2)\nSSE <- sum(residuals^2)\nSSM <- SST - SSE\nMSE <- SSE / (n - ncol(X))\ncat(\"\\nMSE =\", MSE, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMSE = 3.416667 \n```\n\n\n:::\n:::\n\n\n### Define and Test Contrasts\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Three orthogonal contrasts\nc1 <- c(1, 0, -1, 0)     # Angus vs Hereford\nc2 <- c(1, -1, 1, -1)    # British vs Continental  \nc3 <- c(0, 1, 0, -1)     # Charolais vs Simmental\n\n# Check orthogonality\ncat(\"Orthogonality checks:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOrthogonality checks:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"c1' c2 =\", sum(c1 * c2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nc1' c2 = 0 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"c1' c3 =\", sum(c1 * c3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nc1' c3 = 0 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"c2' c3 =\", sum(c2 * c3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nc2' c3 = 0 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Estimate contrasts\nest1 <- sum(c1 * b)\nest2 <- sum(c2 * b)\nest3 <- sum(c3 * b)\n\n# Standard errors (balanced design)\nn_per_group <- 3\nse1 <- sqrt(sum(c1^2) / n_per_group * MSE)\nse2 <- sqrt(sum(c2^2) / n_per_group * MSE)\nse3 <- sqrt(sum(c3^2) / n_per_group * MSE)\n\n# t-statistics\nt1 <- est1 / se1\nt2 <- est2 / se2\nt3 <- est3 / se3\n\n# Results\nresults <- data.frame(\n  Contrast = c(\"Angus - Hereford\", \"British - Continental\", \"Charolais - Simmental\"),\n  Estimate = round(c(est1, est2, est3), 2),\n  SE = round(c(se1, se2, se3), 3),\n  t = round(c(t1, t2, t3), 3),\n  p = round(2 * (1 - pt(abs(c(t1, t2, t3)), 8)), 4)\n)\nprint(results)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Contrast Estimate    SE       t      p\n1      Angus - Hereford     2.67 1.509   1.767 0.1152\n2 British - Continental   -34.00 2.134 -15.930 0.0000\n3 Charolais - Simmental     4.00 1.509   2.650 0.0292\n```\n\n\n:::\n:::\n\n\n::: {.callout-note}\n## Biological Interpretation\n\n- **Angus vs. Hereford**: No significant difference (both British breeds)\n- **British vs. Continental**: Highly significant! Continental breeds ~39 kg heavier\n- **Charolais vs. Simmental**: No significant difference (both Continental)\n\nThis pattern matches breeding history: Continental breeds selected for growth and carcass weight.\n:::\n\n## Realistic Application: Layer Strain Egg Production\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load layer strain data\nlayers <- read.csv(\"data/layer_strains_egg.csv\")\n\n# Summary\nlayers_summary <- layers %>%\n  group_by(strain) %>%\n  summarise(n = n(), mean = mean(eggs_per_month), sd = sd(eggs_per_month))\nprint(layers_summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n  strain             n  mean    sd\n  <chr>          <int> <dbl> <dbl>\n1 HyLineW36         10  29   0.816\n2 ISABrown          10  27   0.816\n3 LohmannBrown      10  26.5 0.850\n4 RhodeIslandRed    10  23   1.49 \n5 WhiteLeghorn      10  28.2 1.03 \n```\n\n\n:::\n:::\n\n\n### Fit Model and Define Contrasts\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit ANOVA\ny_l <- layers$eggs_per_month\nX_l <- model.matrix(~ strain - 1, data = layers)\nb_l <- solve(t(X_l) %*% X_l) %*% t(X_l) %*% y_l\nresid_l <- y_l - X_l %*% b_l\nMSE_l <- sum(resid_l^2) / (length(y_l) - ncol(X_l))\n\n# Contrasts (alphabetical order: HyLineW36, ISABrown, LohmannBrown, RhodeIslandRed, WhiteLeghorn)\nc1_l <- c(-0.25, -0.25, -0.25, 1, -0.25)  # Heritage vs Commercial\nc2_l <- c(0.5, -0.5, -0.5, 0, 0.5)        # White vs Brown\nc3_l <- c(-1, 0, 0, 0, 1)                 # WL vs HyLine\nc4_l <- c(0, 1, -1, 0, 0)                 # ISA vs Lohmann\n\n# Test contrasts\nn_per <- 10\ntest_contrast <- function(c_vec) {\n  est <- sum(c_vec * b_l)\n  se <- sqrt(sum(c_vec^2) / n_per * MSE_l)\n  t_stat <- est / se\n  p_val <- 2 * (1 - pt(abs(t_stat), 45))\n  return(c(est = est, se = se, t = t_stat, p = p_val))\n}\n\nr1 <- test_contrast(c1_l)\nr2 <- test_contrast(c2_l)\nr3 <- test_contrast(c3_l)\nr4 <- test_contrast(c4_l)\n\nlayer_results <- data.frame(\n  Contrast = c(\"Heritage vs Commercial\", \"White vs Brown\", \"WL vs HyLine\", \"ISA vs Lohmann\"),\n  rbind(r1, r2, r3, r4)\n)\ncolnames(layer_results) <- c(\"Contrast\", \"Estimate\", \"SE\", \"t\", \"p\")\nlayer_results[,2:5] <- round(layer_results[,2:5], 4)\nprint(layer_results)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 Contrast Estimate     SE        t      p\nr1 Heritage vs Commercial   -4.675 0.3655 -12.7897 0.0000\nr2         White vs Brown    1.850 0.3269   5.6586 0.0000\nr3           WL vs HyLine   -0.800 0.4624  -1.7302 0.0904\nr4         ISA vs Lohmann    0.500 0.4624   1.0814 0.2853\n```\n\n\n:::\n:::\n\n\n::: {.callout-important}\n## Commercial Implications\n\n- **Heritage vs Commercial**: Significant! Modern strains produce 5+ more eggs/month\n- **White vs Brown**: Significant difference favoring white-egg strains\n- **Within types**: HyLine outperforms Leghorn; ISA and Lohmann similar\n:::\n\n## Building Contrast Testing Tools\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function 1: Check estimability\nis_estimable <- function(c, X, tol = 1e-10) {\n  library(MASS)\n  XtX_ginv <- ginv(t(X) %*% X)\n  projection <- t(X) %*% X %*% XtX_ginv %*% c\n  return(all(abs(projection - c) < tol))\n}\n\n# Function 2: Test single contrast\ntest_single_contrast <- function(c, b, X, sigma2, method = \"balanced\") {\n  n <- nrow(X)\n  p <- ncol(X)\n  estimate <- sum(c * b)\n  \n  if (method == \"balanced\") {\n    variance <- sum(c^2) / (n / p) * sigma2\n  } else {\n    library(MASS)\n    variance <- t(c) %*% ginv(t(X) %*% X) %*% c * sigma2\n  }\n  \n  se <- sqrt(variance)\n  df <- n - qr(X)$rank\n  t_stat <- estimate / se\n  p_value <- 2 * (1 - pt(abs(t_stat), df))\n  \n  return(list(estimate = estimate, se = se, t = t_stat, df = df, p_value = p_value))\n}\n\n# Function 3: Check orthogonality\ncheck_orthogonality <- function(C, X = NULL, method = \"simple\") {\n  if (method == \"simple\") {\n    return(C %*% t(C))\n  } else {\n    library(MASS)\n    XtX_ginv <- ginv(t(X) %*% X)\n    return(C %*% XtX_ginv %*% t(C))\n  }\n}\n\n# Test functions\ncat(\"Testing is_estimable():\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTesting is_estimable():\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"c1 in beef data:\", is_estimable(c1, X), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nc1 in beef data: TRUE \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Testing test_single_contrast():\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTesting test_single_contrast():\n```\n\n\n:::\n\n```{.r .cell-code}\nresult <- test_single_contrast(c1, b, X, MSE, \"balanced\")\ncat(\"Estimate:\", round(result$estimate, 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEstimate: 2.67 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SE:\", round(result$se, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSE: 1.509 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"t:\", round(result$t, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nt: 1.767 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p:\", round(result$p_value, 4), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np: 0.1152 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Testing check_orthogonality():\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTesting check_orthogonality():\n```\n\n\n:::\n\n```{.r .cell-code}\nC_beef <- rbind(c1, c2, c3)\northo_mat <- check_orthogonality(C_beef)\ncat(\"Off-diagonal elements:\", ortho_mat[row(ortho_mat) != col(ortho_mat)], \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOff-diagonal elements: 0 0 0 0 0 0 \n```\n\n\n:::\n:::\n\n\n## Exercises\n\n### Conceptual\n\n1. Prove that in a one-way ANOVA effects model with sum-to-zero constraint, the contrast $\\alpha_i - \\alpha_j$ is estimable even though individual $\\alpha_i$ are not.\n\n2. Explain why orthogonal contrasts partition the treatment sum of squares in balanced designs.\n\n3. In genetic evaluation, explain the difference between testing \"Sire A is different from Sire B\" versus stating \"Sire A has breeding value +10 kg\".\n\n### Computational\n\n1. **Hand Calculations**: Yorkshire (11, 12, 11), Landrace (10, 11, 10), Duroc (9, 10, 9)\n   - Test Yorkshire = Landrace\n   - Test Yorkshire = (Landrace + Duroc)/2\n   - Construct 95% CIs\n\n2. **Non-orthogonal Contrasts**: Create contrasts that are NOT orthogonal and show their SSs don't sum to SS(Treatments).\n\n3. **Verify Estimability**: Use different generalized inverses and show estimable functions remain constant.\n\n### Applied\n\n1. **Broiler Strains**: Design 4 meaningful contrasts comparing fast-growing vs. heritage breeds.\n\n2. **Sheep Breeds**: Test if Dorset and Suffolk (meat breeds) are similar and together different from wool breeds.\n\n## Summary\n\n✓ **Defined** linear contrasts as $\\mathbf{c}'\\boldsymbol{\\beta}$ where $\\sum c_i = 0$\n\n✓ **Determined** estimability using the row space criterion\n\n✓ **Computed** estimates and standard errors for contrasts\n\n✓ **Tested** contrasts using t-tests and F-tests\n\n✓ **Constructed** orthogonal contrast sets\n\n✓ **Interpreted** results in livestock breeding contexts\n\n✓ **Built** custom R functions for contrast testing\n\n**Key concepts**:\n\n- Estimability depends on design matrix structure\n- Contrasts are estimable even when individual parameters are not\n- Orthogonal contrasts partition variation in balanced designs\n- Generalized inverses give different solutions, but estimable functions are unique\n- Contrasts answer specific research questions\n\n## Looking Ahead\n\n- **Week 9**: Contrasts in factorial models with interactions\n- **Week 10**: Adjusted means as estimable functions in ANCOVA\n- **Week 12**: Estimability in unbalanced designs\n\n---\n\n**Previous**: [Week 7: One-Way ANOVA](../Week07_ANOVA_OneWay/Week07_ANOVA_OneWay.qmd)\n\n**Next**: [Week 9: Two-Way ANOVA and Factorial Models](../Week09_TwoWayANOVA/Week09_TwoWayANOVA.qmd)\n",
    "supporting": [
      "Week08_Contrasts_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}